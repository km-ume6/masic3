<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="masic3.MyCode.ViewProcess"
             xmlns:VM="clr-namespace:masic3.MyCode">

    <ContentPage.BindingContext>
        <VM:ViewModelProcess/>
    </ContentPage.BindingContext>

    <ContentPage.Content>
        <Grid>
            <Grid.RowDefinitions>
                <!-- プロセス設定ボタンエリア -->
                <RowDefinition Height="*"/>
                <!-- プロセス入力 -->
                <RowDefinition Height="*"/>
                <!-- プロセス一覧 -->
                <RowDefinition Height="*"/>
                <!-- モニタエリア -->
                <RowDefinition Height="*"/>
                <!-- コマンドエリア -->
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- プロセス設定ボタンエリア -->
            <Grid
                Style="{StaticResource gridStyle}"
                Grid.Row="0"
                >
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>

                <Button Grid.Column="0" Text="追加" Command="{Binding AddProcessItemCommand}"/>
                <Button Grid.Column="1" Text="更新" Command="{Binding UpdateProcessItemCommand}"/>
                <Button Grid.Column="2" Text="削除" Command="{Binding RemoveProcessItemCommand}"/>
                <CheckBox Grid.Column="3" IsChecked="{Binding IsChecked1}"/>
                <Button Grid.Column="4" Text="実行する？"/>
            </Grid>

            <!-- プロセス入力エリア -->
            <Grid
                Style="{StaticResource gridStyle}"
                Grid.Row="1"
                >
                <Grid.RowDefinitions>
                    <RowDefinition/>
                    <RowDefinition/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="0.15*" x:Name="C1_W"/>
                    <ColumnDefinition Width="1.0*" x:Name="C2_W"/>
                    <ColumnDefinition Width="0.3*" x:Name="C3_W"/>
                    <ColumnDefinition Width="*" x:Name="C4_W"/>
                </Grid.ColumnDefinitions>

                <Label Grid.Row="0" Grid.Column="0" Text="番号"
                       VerticalTextAlignment="Center" HorizontalTextAlignment="Center"
                />
                <Label Grid.Row="0" Grid.Column="1" Text="コマンド"
                       VerticalTextAlignment="Center" HorizontalTextAlignment="Center"
                       HorizontalOptions="Center"
                />
                <Label Grid.Row="0" Grid.Column="2" Text="データ"
                       VerticalTextAlignment="Center" HorizontalTextAlignment="Center"
                />
                <Label Grid.Row="0" Grid.Column="3" Text="時間"
                       VerticalTextAlignment="Center" HorizontalOptions="Center"
                />
                <Label Grid.Row="1" Grid.Column="0" Text="{Binding EditProcessId}"
                       VerticalTextAlignment="Center" HorizontalTextAlignment="End"
                       BackgroundColor="DarkOliveGreen"
                       x:Name="C1_HTA"
                />
                <Entry Grid.Row="1" Grid.Column="1" Text="{Binding EditProcessName}"
                       VerticalTextAlignment="Center" HorizontalTextAlignment="End"
                       BackgroundColor="DarkOliveGreen"
                       x:Name="C2_HTA"
                />
                <Entry Grid.Row="1" Grid.Column="2" Text="{Binding EditProcessData}"
                       HorizontalTextAlignment="End"
                       BackgroundColor="DarkOliveGreen"
                       x:Name="C3_HTA"
                />
                <StackLayout Grid.Row="1" Grid.Column="3" BackgroundColor="DarkOliveGreen" Padding="0,6,0,0">
                    <TimePicker Time="{Binding EditProcessTime}" Format="HH:mm"
                                HorizontalOptions="Center"
                                BackgroundColor="DarkOliveGreen"
                                x:Name="C4_HTA"
                    />
                </StackLayout>
            </Grid>

            <!-- プロセス一覧エリア(CollectionView) -->
            <Grid
                Style="{StaticResource gridStyle}"
                Grid.Row="2"
                Margin="10"
                VerticalOptions="FillAndExpand"
                >
                <CollectionView x:Name="ProcessItemCV" ItemsSource="{Binding ProcessItems}" SelectionMode="Single" SelectedItem="{Binding SelectedProcessItem}" SelectionChangedCommand="{Binding BindSelectionChanged}">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="{Binding Source={x:Reference C1_W}, Path=Width}"/>
                                    <ColumnDefinition Width="{Binding Source={x:Reference C2_W}, Path=Width}"/>
                                    <ColumnDefinition Width="{Binding Source={x:Reference C3_W}, Path=Width}"/>
                                    <ColumnDefinition Width="{Binding Source={x:Reference C4_W}, Path=Width}"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Column="0" Text="{Binding ProcessId}" HeightRequest="25" HorizontalTextAlignment="{Binding Source={x:Reference C1_HTA}, Path=HorizontalTextAlignment}"/>
                                <Label Grid.Column="1" Text="{Binding ProcessCommand}" HorizontalTextAlignment="{Binding Source={x:Reference C2_HTA}, Path=HorizontalTextAlignment}"/>
                                <Label Grid.Column="2" Text="{Binding ProcessData}" HorizontalTextAlignment="{Binding Source={x:Reference C3_HTA}, Path=HorizontalTextAlignment}"/>
                                <Label Grid.Column="3" Text="{Binding ProcessTimeToString}" HorizontalOptions="Center"/>
                            </Grid>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </Grid>

            <!-- モニタエリア -->
            <Grid 
                Style="{StaticResource gridStyle}"
                Grid.Row="3"
                >
                <Label Text="モニタ"/>
            </Grid>

            <!-- コマンドエリア -->
            <StackLayout Grid.Row="4" Padding="5" VerticalOptions="FillAndExpand">
                <Button VerticalOptions="FillAndExpand" HorizontalOptions="FillAndExpand" Text="終了" Command="{Binding FinalizationCommand}"/>
            </StackLayout>
        </Grid>
    </ContentPage.Content>
</ContentPage>